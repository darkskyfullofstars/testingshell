
#   Description:
# This script disables unwanted Windows services. If you do not want to disable
# certain services comment out the corresponding lines below.
function enableServices {
  foreach ($service in @(
      "*AarSvc_4183a      *" 
"*AJRouter          *" 
"*ALG               *" 
"*AppIDSvc          *" 
"*Appinfo           *" 
"*AppMgmt           *" 
"*AppReadiness      *" 
"*AppVClient        *" 
"*AppXSvc           *" 
"*Audiosrv          *" 
"*autotimesvc       *" 
"*AxInstSV          *" 
"*BDESVC            *" 
"*BFE               *" 
"*BITS              *" 
"*brave             *" 
"*bravem            *" 
"*BTAGService       *" 
"*BthAvctpSvc       *" 
"*bthserv           *" 
"*camsvc            *" 
"*cbdhsvc_4183a     *" 
"*CDPSvc            *" 
"*CDPUserSvc_4183a  *" 
"*CertPropSvc       *" 
"*ClipSVC           *" 
"*COMSysApp         *" 
"*CryptSvc          *" 
"*CscService        *" 
"*DcomLaunch        *" 
"*defragsvc         *" 
"*DeviceInstall     *" 
"*DevQueryBroker    *" 
"*Dhcp              *" 
"*diagsvc           *" 
"*DiagTrack         *" 
"*DmEnrollmentSvc   *" 
"*dmwappushservice  *" 
"*Dnscache          *" 
"*DoSvc             *" 
"*dot3svc           *" 
"*DPS               *" 
"*DsmSvc            *" 
"*DsSvc             *" 
"*DusmSvc           *" 
"*Eaphost           *" 
"*edgeupdate        *" 
"*edgeupdatem       *" 
"*EFS               *" 
"*embeddedmode      *" 
"*EntAppSvc         *" 
"*EventLog          *" 
"*EventSystem       *" 
"*Fax               *" 
"*fdPHost           *" 
"*FDResPub          *" 
"*fhsvc             *" 
"*FontCache         *" 
"*FrameServer       *" 
"*gpsvc             *" 
"*GraphicsPerfSvc   *" 
"*hidserv           *" 
"*HvHost            *" 
"*icssvc            *" 
"*IKEEXT            *" 
"*InstallService    *" 
"*iphlpsvc          *" 
"*IpxlatCfgSvc      *" 
"*KeyIso            *" 
"*KtmRm             *" 
"*LanmanServer      *" 
"*LanmanWorkstation *" 
"*lfsvc             *" 
"*LicenseManager    *" 
"*lltdsvc           *" 
"*lmhosts           *" 
"*LSM               *" 
"*LxpSvc            *" 
"*MapsBroker        *" 
"*mpssvc            *" 
"*MSDTC             *" 
"*MSiSCSI           *" 
"*msiserver         *" 
"*MsKeyboardFilter  *" 
"*NcaSvc            *" 
"*NcbService        *" 
"*NcdAutoSetup      *" 
"*Netlogon          *" 
"*Netman            *" 
"*netprofm          *" 
"*NetSetupSvc       *" 
"*NetTcpPortSharing *" 
"*NgcCtnrSvc        *" 
"*NgcSvc            *" 
"*NlaSvc            *" 
"*nsi               *" 
"*OneSyncSvc_4183a  *" 
"*p2pimsvc          *" 
"*p2psvc            *" 
"*PcaSvc            *" 
"*PeerDistSvc       *" 
"*PerfHost          *" 
"*PhoneSvc          *" 
"*pla               *" 
"*PlugPlay          *" 
"*PNRPAutoReg       *" 
"*PNRPsvc           *" 
"*PolicyAgent       *" 
"*Power             *" 
"*PrintNotify       *" 
"*ProfSvc           *" 
"*PushToInstall     *" 
"*QWAVE             *" 
"*RasAuto           *" 
"*RasMan            *" 
"*RemoteAccess      *" 
"*RemoteRegistry    *" 
"*RetailDemo        *" 
"*RmSvc             *" 
"*RpcEptMapper      *" 
"*RpcLocator        *" 
"*RpcSs             *" 
"*SamSs             *" 
"*SCardSvr          *" 
"*ScDeviceEnum      *" 
"*Schedule          *" 
"*SCPolicySvc       *" 
"*SDRSVC            *" 
"*seclogon          *" 
"*SEMgrSvc          *" 
"*SENS              *" 
"*Sense             *" 
"*SensorDataService *" 
"*SensorService     *" 
"*SensrSvc          *" 
"*SessionEnv        *" 
"*SgrmBroker        *" 
"*SharedAccess      *" 
"*SharedRealitySvc  *" 
"*ShellHWDetection  *" 
"*shpamsvc          *" 
"*smphost           *" 
"*SmsRouter         *" 
"*SNMPTRAP          *" 
"*spectrum          *" 
"*Spooler           *" 
"*sppsvc            *" 
"*SSDPSRV           *" 
"*ssh-agent         *" 
"*SstpSvc           *" 
"*StateRepository   *" 
"*stisvc            *" 
"*StorSvc           *" 
"*svsvc             *" 
"*swprv             *" 
"*SysMain           *" 
"*SystemEventsBroker*" 
"*TabletInputService*" 
"*TapiSrv           *" 
"*TermService       *" 
"*Themes            *" 
"*TimeBrokerSvc     *" 
"*TokenBroker       *" 
"*TrkWks            *" 
"*TroubleshootingSvc*" 
"*TrustedInstaller  *" 
"*tzautoupdate      *" 
"*UdkUserSvc_4183a  *" 
"*UevAgentService   *" 
"*uhssvc            *" 
"*UmRdpService      *" 
"*UnistoreSvc_4183a *" 
"*upnphost          *" 
"*UserDataSvc_4183a *" 
"*UserManager       *" 
"*UsoSvc            *" 
"*VacSvc            *" 
"*VaultSvc          *" 
"*vds               *" 
"*vmicguestinterface*" 
"*vmicheartbeat     *" 
"*vmickvpexchange   *" 
"*vmicrdv           *" 
"*vmicshutdown      *" 
"*vmictimesync      *" 
"*vmicvmsession     *" 
"*vmicvss           *" 
"*VSS               *" 
"*W32Time           *" 
"*WaaSMedicSvc      *" 
"*WalletService     *" 
"*WarpJITSvc        *" 
"*wbengine          *" 
"*WbioSrvc          *" 
"*Wcmsvc            *" 
"*wcncsvc           *" 
"*WdiServiceHost    *" 
"*WdiSystemHost     *" 
"*WdNisSvc          *" 
"*WebClient         *" 
"*Wecsvc            *" 
"*WEPHOSTSVC        *" 
"*wercplsupport     *" 
"*WerSvc            *" 
"*WFDSConMgrSvc     *" 
"*WiaRpc            *" 
"*WinDefend         *" 
"*Winmgmt           *" 
"*WinRM             *" 
"*wisvc             *" 
"*WlanSvc           *" 
"*wlidsvc           *" 
"*wlpasvc           *" 
"*WManSvc           *" 
"*wmiApSrv          *" 
"*WMPNetworkSvc     *" 
"*workfolderssvc    *" 
"*WpcMonSvc         *" 
"*WPDBusEnum        *" 
"*WpnService        *" 
"*wscsvc            *" 
"*WSearch           *" 
"*wuauserv          *" 
"*WwanSvc           *" 
"*XblAuthManager    *" 
"*XblGameSave       *" 
"*XboxGipSvc        *" 
"*XboxNetApiSvc *"
    )) {
    Get-Service -Name $service | Set-Service -StartupType Disabled -ea 0 | Out-Null
  }
}
